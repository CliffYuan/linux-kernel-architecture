<!DOCTYPE HTML>
<html>
<!-- <html> -->
<head>
  <title>进程生命周期|Linux Kernel Architecture 内核笔记</title>
  <meta charset="utf-8" />
<link rel="alternate" type="application/atom+xml" title="Recent Entries" href="/feed.xml">
<link rel="icon" href="/images/icons/avatar.png">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="/style/css/bootstrap.css" type="text/css" media="screen">
<link rel="stylesheet" href="/style/css/syntax.css" type="text/css" media="screen">
<script type="text/javascript" src="/style/jquery-1.7.1.min.js"></script>


<link rel="stylesheet" href="/style/style.css" type="text/css">

<script>
$(document).ready(function(){
    $('.nav a').hover(
        function(){
            $(this).animate({opacity: 0.3}, 400)
        }, 
        function(){
            $(this).animate({opacity: 1}, 400)
        });
});
function getURLParameter(name) {
    return decodeURI(
        (RegExp(name + '=' + '(.+?)(&|$)').exec(location.search)||[,null])[1]
    );
}
</script>

<style>
.archive li {
    list-style: decimal;
    margin-left: 50px;
    line-height: 2em;
}

.archive .year {
    list-style: none;
}
</style>
  <script type="text/javascript">
        var BYB = {};
  </script>
  <script type="text/javascript">
    BYB.includeScript = function(file,callback){
    var _doc = document.getElementsByTagName('head')[0];
    var js = document.createElement('script');
    js.setAttribute('type', 'text/javascript');
    js.setAttribute('src', file);
    _doc.appendChild(js);
    
    if (!/*@cc_on!@*/0) { //if not IE
    //Firefox2、Firefox3、Safari3.1+、Opera9.6+ support js.onload
    js.onload = function () {
    callback();
    }
    } else {
    //IE6、IE7 support js.onreadystatechange
    js.onreadystatechange = function () {
    if (js.readyState == 'loaded' || js.readyState == 'complete') {
    callback();
    }
    }
    }
    return false;
    }
  </script>
  <meta content="linux kernel architecture 内核笔记 进程生命周期..." name="description"/>
  <meta content="进程,生命周期,抢占式,多任务处理," name="keywords"/>
  <meta property="og:type" content="article" />
  <meta property="og:url" content="http://guojing.me/linux-kernel-architecture//posts/process-life/" />
  <meta property="og:title" content="进程生命周期" />
  <meta property="og:description" content="linux kernel architecture 内核笔记 进程生命周期..." />
</head>
<body>

<div class="banner">
<ul class="nav nav-pills">
  <li><a href="/" class="glyphicon glyphicon-inbox"> Home</a></li>
  <li><a href="/archive" class="glyphicon glyphicon-floppy-disk"> Archive</a></li>
  <li><a href="/linux-kernel-architecture/archive/" class="glyphicon glyphicon-book"> Kernel</a></li>
  <li><a href="/about" class="glyphicon glyphicon-record"> About</a></li>
</ul>
</div>

<div class="container">

<div class="main clearfix">
  <div class="title">进程生命周期</div>

  <div class="content 进程_content_css">
    <p>进程并不是总是可以立即运行的，有时候进程需要等待来自外部的信号源、不受其控制的事件，例如在文本编辑器中等待键盘输入，在事件发生之前，进程都无法运行。当进程调度器运行的时候，必须知道系统中每个进程的状态。将CPU时间分配到无事可做的进程是没有意义而且也是浪费资源的。进程在各个状态之间的转换也同样重要，如果一个进程在等待来自外设的数据，那么调度器的职责是一旦数据已经到达，则需要将进程的状态由等待改为可运行（<em>TASK_RUNNING</em>）。</p>

<p>进程的运行状态可以看<a href="http://guojing.me/linux-kernel-architecture/posts/process-descriptor/">《进程描述符》</a>。</p>

<p>系统将所有进程保存在一个进程中，无论状态是运行、睡眠还是等待。但睡眠的进程会特别标记出来，调度器会知道它们无法立即运行，睡眠进程会分类到若干<em>队列</em><sup id="fnref:1"><a href="#fn:1" class="footnote">1</a></sup>中，因此它们可在适当的时间唤醒，例如在进程等待的外部时间已经发生时<sup id="fnref:2"><a href="#fn:2" class="footnote">2</a></sup>。</p>

<p>对于一个排队中的可运行的进程，我们可以考虑各种转换状态。如果这个进程就绪，但没有运行，因为CPU分配给了其他进程，所以这个进程的状态是等待。在调度器授予CPU时间之前，进程会一直保持该状态。在CPU分配时间之后，其状态改为『运行』。</p>

<p>在调度器决定从该进程收回CPU资源时，过程状态从运行改变为等待，然后循环重新开始。如果进程必须等待事件，则状态从运行改变为睡眠状态。但进程无法直接从睡眠状态变为运行。在所等待的事件发生之后，进程先时变回到『等待』状态，然后进入队列等待循环。</p>

<p>在程序终止，过程状态改为终止。</p>

<h3 id="section">抢占式多任务处理</h3>

<p>Linux进程管理的结构中还需要另外两种进程状态选项：用户态和核心态。这反应了所有CPU都至少有两种不同执行状态的事实。其中一种具有无限的权利，另一种则有各种限制。进程通常都处于用户态，只能访问自身的数据，无法感染系统中其他的应用程序，甚至也不会注意到自身之外的其他程序的存在。如果进程想要访问系统数据或功能，则必须切换到核心态。这种转换是应用程序有意调用的。</p>

<p>从用户态切换到核心太的另一个方法是通过<strong>中断</strong>，此时切换是自动触发的。系统调用是由应用程序有意调用的，中断则不同，其发生或多或少是不可预测的。处理中断的操作，通常与中断发生时执行的进程无关。例如外部设备向内存传输数据完毕则可能引发一个中断。例如进入系统的网络数据，也会发送中断。在Linux执行中断操作时，当前运行的进程不会察觉。</p>

<p>内核抢占调度模型建立了一个层次结构，用于判断哪些进程状态可以由其他状态抢占：</p>

<ol>
  <li>普通进程总是可以被抢占的，甚至由其他普通进程抢占。</li>
  <li>如果系统处于核心态并正在处理系统调用，那么其他进程无法夺取其CPU时间，但中断可以中止系统调用。</li>
  <li>中断可以暂停处于用户状态和核心状态的进程，中断具有最高优先级，因为中断触发后需要尽快处理。</li>
</ol>

<p>内核抢占可以减少等待时间，因而保证『更平滑的』程序执行，但这样会增加内核复杂度，因为许多的数据需要进行并发保护，即便时在单处理器系统。</p>
<div class="footnotes">
  <ol>
    <li id="fn:1">
      <p>根据进程的状态，可能会有若干队列，当状态转换时，只要进入相应队列即可。 <a href="#fnref:1" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:2">
      <p>如等待I/O，如果没有返回则可以处于睡眠状态，一旦I/O完成，则从睡眠状态中改为可运行状态。 <a href="#fnref:2" class="reversefootnote">&#8617;</a></p>
    </li>
  </ol>
</div>

  </div>

  <div class="forb">
  
  <a href="http://guojing.me/linux-kernel-architecture/tags/#进程">#进程</a>
  
  <a href="http://guojing.me/linux-kernel-architecture/tags/#生命周期">#生命周期</a>
  
  <a href="http://guojing.me/linux-kernel-architecture/tags/#抢占式">#抢占式</a>
  
  <a href="http://guojing.me/linux-kernel-architecture/tags/#多任务处理">#多任务处理</a>
  
  </div>

  <div class="suggest">
    
        <a href="http://guojing.me/linux-kernel-architecture/posts/process-priority/" class="pre">&lt; 进程优先级</a>
    
    
    
        <a href="http://guojing.me/linux-kernel-architecture/posts/process-type-and-namespace/" class="next">进程类型和命名空间 &gt;</a>
    
    </div>
</div>

<!--
<div class="comments 进程_comments_css">
<div id="disqus_container"> 
    
    <a href="#" class="comment" onclick="return false;">点击评论或查看评论。</a>
        
    <div id="disqus_thread"></div>
</div>
</div>
-->

<script type="text/javascript">
    $(document).ready(function(){
        $('#disqus_container .comment').on('click',function(){
            $(this).html('加载中...');
    var disqus_shortname = 'jguoer';
            var that = this;
            BYB.includeScript('http://' + disqus_shortname + '.disqus.com/embed.js',function(){$(that).remove()});
        });
});
</script>

<!--
  Copryright GuoJing 未经允许，严禁直接从Github上转载我的文章，所有文章遵循CC协议，允许复制和转载，但需要保留原作者链接。
  该文章进程生命周期写于2014年04月02日。
-->

</div>
<div class="footer">
<!--
    Copyright GuoJing, Theme designed by GuoJing
    Theme name Simple
    If you love this theme, please keep my copyright and link to my blog.
    If you DON'T LIKE it and you CAN remove the link. but not share spirit.
    如果你喜欢这个博客构架和皮肤，请保留我作为原作者的权利，我会感谢你。
    你也可以不保留我作为原作者的权利，自然没有任何问题，但似乎没有共享精神。
-->
<!-- © Copryright by<a href="http://guojing.me/" target="_blank">GuoJing</a> 2012-2014 using <a href="http://www.github.com/" target="_blank">GitHub</a> and <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> -->
<div class="author">
    <div class="icon">
        <img src="/images/authors/guojing.jpg" alt="me"/>
    </div>
    <div class="name">
        <a href="/about">GuoJing</a>
    </div>
    <div class="description">
        Linux Kernel Architecture 内核笔记
    </div>
</div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-42721249-1', 'guojing.me');
  ga('send', 'pageview');

</script>
</div>

</body>
</html>
