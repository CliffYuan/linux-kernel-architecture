<!DOCTYPE HTML>
<html>
<!-- <html> -->
<head>
  <title>进程地址空间|Linux Kernel Architecture 内核笔记</title>
  <meta charset="utf-8" />
<link rel="alternate" type="application/atom+xml" title="Recent Entries" href="/feed.xml">
<link rel="icon" href="/images/icons/avatar.png">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="/style/css/bootstrap.css" type="text/css" media="screen">
<link rel="stylesheet" href="/style/css/syntax.css" type="text/css" media="screen">
<script type="text/javascript" src="/style/jquery-1.7.1.min.js"></script>


<link rel="stylesheet" href="/style/style.css" type="text/css">

<script>
$(document).ready(function(){
    $('.nav a').hover(
        function(){
            $(this).animate({opacity: 0.3}, 400)
        }, 
        function(){
            $(this).animate({opacity: 1}, 400)
        });
});
function getURLParameter(name) {
    return decodeURI(
        (RegExp(name + '=' + '(.+?)(&|$)').exec(location.search)||[,null])[1]
    );
}
</script>

<style>
.archive li {
    list-style: decimal;
    margin-left: 50px;
    line-height: 2em;
}

.archive .year {
    list-style: none;
}
</style>
  <script type="text/javascript">
        var BYB = {};
  </script>
  <script type="text/javascript">
    BYB.includeScript = function(file,callback){
    var _doc = document.getElementsByTagName('head')[0];
    var js = document.createElement('script');
    js.setAttribute('type', 'text/javascript');
    js.setAttribute('src', file);
    _doc.appendChild(js);
    
    if (!/*@cc_on!@*/0) { //if not IE
    //Firefox2、Firefox3、Safari3.1+、Opera9.6+ support js.onload
    js.onload = function () {
    callback();
    }
    } else {
    //IE6、IE7 support js.onreadystatechange
    js.onreadystatechange = function () {
    if (js.readyState == 'loaded' || js.readyState == 'complete') {
    callback();
    }
    }
    }
    return false;
    }
  </script>
  <meta content="linux kernel architecture 内核笔记 进程地址空间，寻址..." name="description"/>
  <meta content="task_size," name="keywords"/>
  <meta property="og:type" content="article" />
  <meta property="og:url" content="http://guojing.me/linux-kernel-architecture//posts/task-size/" />
  <meta property="og:title" content="进程地址空间" />
  <meta property="og:description" content="linux kernel architecture 内核笔记 进程地址空间，寻址..." />
</head>
<body>

<div class="banner">
<ul class="nav nav-pills">
  <li><a href="/">Home</a></li>
  <li><a href="/archive/">Archive</a></li>
  <li><a href="/linux-kernel-architecture/archive/">Kernel</a></li>
</ul>

</div>

<div class="container">

<div class="main clearfix">
  <div class="title">进程地址空间</div>

  <div class="content 基础_content_css">
    <p>由于内存区域是通过指针寻址，因此CPU的字长，如32位，64位决定了所能管理的地址的空间的最大长度。对64位的处理器而言，可以管理2^64B的长度。</p>

<p>地址空间的最大长度和实际可用的物理内存数量无关，因此被称为<strong>虚拟地址</strong>空间。从系统中每个进程的角度来看，地址空间中只有自己一个进程，因为无法感知其他进程的存在，况且，应用程序也不需要关注其他应用程序的存在，就好像计算机中只有一个进程一样。</p>

<p>Linux将虚拟地址空间划分为两个部分，分别称为<strong>内核空间</strong>和<strong>用户空间</strong>。</p>

<p class="center"><img src="/linux-kernel-architecture/images/task-size.png" alt="system" style="max-width:300px" /></p>

<p class="center">进程地址空间</p>

<p>系统中每个用户进程都有自身的虚拟地址范围，从0到TASK_SIZE。其中内核空间保留给内核专用，用户的进程不能访问。TASK_SIZE是一个特定于计算机体系结构的常数。比如在某些系统中，地址空间在3x2^30处划分，因此每个进程的虚拟地址空间是3x2^30长。假设虚拟地址空间的总长度4x2^30，那么留给内核的就是1x2^30<sup id="fnref:1"><a href="#fn:1" class="footnote">1</a></sup>。不同的计算机，体系结构的划分也不尽相同。</p>

<p>这种划分与可用内存的数量无关。由于地址空间虚拟化的结果，每个用户进程都认为自己有3x2^30长的地址空间，各个系统进程的用户空间是完全彼此分离的。</p>

<p>64位计算机的情况更加复杂，因为它们在实际管理自身巨大的虚拟地址空间时，更倾向于使用小于64的位数<sup id="fnref:2"><a href="#fn:2" class="footnote">2</a></sup>。因此，地址空间中实际可寻址的部分小于理论长度。但无论怎样，该值仍大于计算机上实际可能的内存数量，是完全够用的。这种做法的一个优点是，与寻址完整的虚拟地址空间相比，管理有效地址空间所需的位数较少，因此CPU可以节省一些工作量<sup id="fnref:3"><a href="#fn:3" class="footnote">3</a></sup>。</p>

<div class="footnotes">
  <ol>
    <li id="fn:1">
      <p>虚拟地址空间的顶部和内核空间总是同样的，无论当前执行的是哪个进程。 <a href="#fnref:1" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:2">
      <p>如42位或47位。 <a href="#fnref:2" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:3">
      <p>但这样，虚拟地址空间会包含一些不可寻址的洞。 <a href="#fnref:3" class="reversefootnote">&#8617;</a></p>
    </li>
  </ol>
</div>

  </div>

  <div class="forb">
  
  <a href="http://guojing.me/linux-kernel-architecture/tags/#task_size">#task_size</a>
  
  </div>

  <div class="suggest">
    
        <a href="http://guojing.me/linux-kernel-architecture/posts/red-and-black-tree-with-c-code/" class="pre">&lt; 红黑树</a>
    
    
    
        <a href="http://guojing.me/linux-kernel-architecture/posts/progress-model/" class="next">进程内核模式 &gt;</a>
    
    </div>
</div>

<!--
<div class="comments 基础_comments_css">
<div id="disqus_container"> 
    
    <a href="#" class="comment" onclick="return false;">点击评论或查看评论。</a>
        
    <div id="disqus_thread"></div>
</div>
</div>
-->

<script type="text/javascript">
    $(document).ready(function(){
        $('#disqus_container .comment').on('click',function(){
            $(this).html('加载中...');
    var disqus_shortname = 'jguoer';
            var that = this;
            BYB.includeScript('http://' + disqus_shortname + '.disqus.com/embed.js',function(){$(that).remove()});
        });
});
</script>

<!--
  Copryright GuoJing 未经允许，严禁直接从Github上转载我的文章，所有文章遵循CC协议，允许复制和转载，但需要保留原作者链接。
  该文章进程地址空间写于2014年03月15日。
-->

</div>
<div class="footer">
<!--
    Copyright GuoJing, Theme designed by GuoJing
    Theme name Simple
    If you love this theme, please keep my copyright and link to my blog.
    If you DON'T LIKE it and you CAN remove the link. but not share spirit.
    如果你喜欢这个博客构架和皮肤，请保留我作为原作者的权利，我会感谢你。
    你也可以不保留我作为原作者的权利，自然没有任何问题，但似乎没有共享精神。
-->
<!-- © Copryright by<a href="http://guojing.me/" target="_blank">GuoJing</a> 2012-2014 using <a href="http://www.github.com/" target="_blank">GitHub</a> and <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> -->
<div class="author">
    <div class="icon">
        <img src="/images/authors/guojing.jpg" alt="me"/>
    </div>
    <div class="name">
        <a href="/about">GuoJing</a>
    </div>
    <div class="description">
        Linux Kernel Architecture 内核笔记
    </div>
</div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-42721249-1', 'guojing.me');
  ga('send', 'pageview');

</script>
</div>

</body>
</html>
